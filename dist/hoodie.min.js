// Hoodie.js - 0.8.1
// https://github.com/hoodiehq/hoodie.js
// Copyright 2012 - 2014 https://github.com/hoodiehq/
// Licensed Apache License 2.0

!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):"undefined"!=typeof window?window.Hoodie=e():"undefined"!=typeof global?global.Hoodie=e():"undefined"!=typeof self&&(self.Hoodie=e())}(function(){return function e(o,n,d){function f(t,u){if(!n[t]){if(!o[t]){var l="function"==typeof require&&require;if(!u&&l)return l(t,!0);if(i)return i(t,!0);throw new Error("Cannot find module '"+t+"'")}var p=n[t]={exports:{}};o[t][0].call(p.exports,function(e){var n=o[t][1][e];return f(n?n:e)},p,p.exports,e,o,n,d)}return n[t].exports}for(var i="function"==typeof require&&require,t=0;t<d.length;t++)f(d[t]);return f}({1:[function(e,o){function n(e){if(!e||"[object Object]"!==f.call(e)||e.nodeType||e.setInterval)return!1;var o=d.call(e,"constructor"),n=d.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!o&&!n)return!1;var i;for(i in e);return void 0===i||d.call(e,i)}var d=Object.prototype.hasOwnProperty,f=Object.prototype.toString;o.exports=function i(){var e,o,d,f,t,u,l=arguments[0]||{},p=1,c=arguments.length,s=!1;for("boolean"==typeof l&&(s=l,l=arguments[1]||{},p=2),"object"!=typeof l&&"function"!=typeof l&&(l={});c>p;p++)if(null!=(e=arguments[p]))for(o in e)d=l[o],f=e[o],l!==f&&(s&&f&&(n(f)||(t=Array.isArray(f)))?(t?(t=!1,u=d&&Array.isArray(d)?d:[]):u=d&&n(d)?d:{},l[o]=i(s,u,f)):void 0!==f&&(l[o]=f));return l}},{}],2:[function(e,o){function n(e){var o=this;if(!(o instanceof n))throw new Error("usage: new Hoodie(url);");o.baseUrl=e?e.replace(/\/+$/,""):"",o.extend=function(e){e(o)},o.extend(w),o.extend(u),o.extend(s),o.extend(p),o.extend(c),o.extend(i),o.extend(t),o.extend(l),o.extend(y),o.on("account:cleanup",b.config.clear),o.id.init(),o.account.username=b.config.get("_account.username"),o.remote.init(),o.account.checkPasswordReset(),o.id.subscribeToOutsideEvents(),o.store.subscribeToOutsideEvents(),o.store.bootstrapDirtyObjects(),o.remote.subscribeToOutsideEvents(),o.task.subscribeToOutsideEvents(),o.account.authenticate().then(function(){o.remote.connect()}),f.addEventListener("online",o.checkConnection,!1),f.addEventListener("offline",o.checkConnection,!1),o.checkConnection(),d(o)}function d(e){for(var o=0;o<r.length;o++)r[o](e,a,b)}var f="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},i=e("./hoodie/account"),t=e("./hoodie/remote"),u=e("./hoodie/connection"),l=e("./hoodie/id"),p=e("./hoodie/store"),c=e("./hoodie/task"),s=e("./hoodie/open"),y=e("./hoodie/request"),w=e("./lib/events"),a=e("./lib"),b=e("./utils"),r=[];n.extend=function(e){r.push(e)},o.exports=n},{"./hoodie/account":3,"./hoodie/connection":4,"./hoodie/id":5,"./hoodie/open":6,"./hoodie/remote":7,"./hoodie/request":8,"./hoodie/store":9,"./hoodie/task":10,"./lib":16,"./lib/events":15,"./utils":26}],3:[function(e,o){function n(e){function o(e){return u.set(Y,e)}function n(){return u.get(Y)}function w(){return u.unset(Y)}function a(){e.on("remote:error:unauthenticated",b)}function b(){return T=void 0,U.authenticate()}function r(e){return U.username!==e?(U.username=e,u.set("_account.username",e)):void 0}function H(e){return e.userCtx.name?(T=!0,y(U.username)):U.hasAnonymousAccount()?U.signIn(U.username,n()):(T=!1,U.trigger("error:unauthenticated"),p())}function g(e,o){return function(n){return U.trigger("signup",e),V._rev=n.rev,x(e,o,{moveData:!0})}}function m(e){return function(o){return"HoodieConflictError"===o.name&&(o.message="Username "+e+" already exists"),s(o)}}function x(e,o,n,f){return f||(f=l()),d.setTimeout(function(){var d=R(e,o,n);d.done(f.resolve),d.fail(function(d){"HoodieAccountUnconfirmedError"===d.name?x(e,o,n,f):f.reject.apply(f,arguments)})},300),f.promise()}function j(o){return o=o||{},function(n){function d(){return r(f),T=!0,o.silent||u||(U.hasAnonymousAccount()?U.trigger("signin:anonymous",f):U.trigger("signin",f,i)),u&&U.trigger("reauthenticated",f),U.fetch(),y(f)}var f,i,t,u,l;return f=n.name.replace(/^user(_anonymous)?\//,""),t=U.username,u=f===t,i=n.roles[0],-1!==n.roles.indexOf("error")?U.fetch(f).then(function(){return s(V.$error)}):-1===n.roles.indexOf("confirmed")?s({name:"HoodieAccountUnconfirmedError",message:"Account has not been confirmed yet"}):u?d():o.moveData?e.store.findAll().then(function(e){l=e}).then(E).then(d).done(function(){l.forEach(function(o){var n=o.type;("$config"!==n||"hoodie"!==o.id)&&(delete o.type,o.createdBy=e.id(),e.store.add(n,o))})}):E().then(d)}}function h(e){var o;return e.$error?(o=e.$error,o.object=e,delete o.object.$error):o={name:"HoodiePendingError",message:"Password reset is still pending"},s(o)}function k(e){return"HoodieUnauthorizedError"===e.name?(u.unset("_account.resetPasswordId"),U.trigger("passwordreset"),c()):s(e)}function q(){var e=l();return U.one("passwordreset",e.resolve),U.on("error:passwordreset",v),U.on("error:passwordreset",e.reject),e.always(function(){U.unbind("passwordreset",e.resolve),U.unbind("error:passwordreset",v),U.unbind("error:passwordreset",e.reject)}),e.promise()}function v(e){var o=e.object,n=o.name,d=n.substr(15),f="/_users/"+encodeURIComponent(X+":"+n),i=btoa(n+":"+d);o._deleted=!0;var t={headers:{Authorization:"Basic "+i},contentType:"application/json",data:JSON.stringify(o)};U.request("PUT",f,t),u.unset("_account.resetPasswordId")}function z(e,o,n){return R(U.username,e,{silent:!0}).then(function(){return U.fetch().then(K(e,o,n))})}function A(e,o){var d=n();return z(d,e,o).done(function(){U.trigger("signup",e),w()})}function B(){return e.remote.disconnect(),V._deleted=!0,N("updateUsersDoc",function(){U.request("PUT",J(),{data:JSON.stringify(V),contentType:"application/json"})})}function C(e){return"HoodieNotFoundError"===e.name?c():s(e)}function D(){return U.trigger("cleanup"),T=void 0,r(void 0),c()}function E(){return e.remote.disconnect(),D()}function F(){return D().then(function(){return U.trigger("signout")})}function G(o){var n;return n=o===e.id()?"user_anonymous":"user",""+n+"/"+o}function I(e){return e=e||U.username,""+X+":"+G(e)}function J(e){return"/_users/"+encodeURIComponent(I(e))}function K(e,o,n){return function(){var d=i({},V);o&&(d.$newUsername=o),d.updatedAt=S(),d.signedUpAt=d.signedUpAt||S(),void 0!==n&&(delete d.salt,delete d.password_sha,d.password=n);var f={data:JSON.stringify(d),contentType:"application/json"};return N("updateUsersDoc",function(){return U.request("PUT",J(),f).then(L(o,n||e))})}}function L(o,n){return function(){return e.remote.disconnect(),o?M(U.username,n).then(function(){return U.signOut({silent:!0,ignoreLocalChanges:!0}).then(function(){return U.signIn(o,n,{moveData:!0})})}):U.signIn(U.username,n)}}function M(e,o,n){n||(n=l());var f={data:{name:G(e),password:o}};return N("signIn",function(){return U.request("POST","/_session",f)}).done(function(){d.setTimeout(M,300,e,o,n)}).fail(function(e){return 401===e.status?n.resolve():(n.reject(e),void 0)}),n.promise()}function N(e,o){return void 0!==W[e]&&"function"==typeof W[e].abort&&W[e].abort(),W[e]=o(),W[e]}function O(e,o){return void 0!==W[e]&&"function"==typeof W[e].state&&"pending"===W[e].state()?W[e]:(W[e]=o(),W[e])}function P(o){return e.store.hasLocalChanges()&&!o.ignoreLocalChanges?e.remote.push():c()}function Q(){return O("signOut",function(){return U.request("DELETE","/_session")})}function R(e,o,n){var d={data:{name:G(e),password:o}};return N("signIn",function(){var e=U.request("POST","/_session",d);return e.then(j(n))})}function S(){return new Date}var T,U={},V={},W={},X="org.couchdb.user";f(e,{context:U,namespace:"account"}),U.authenticate=function(){var e;return T===!1?p():T===!0?y(U.username):W.signOut&&"pending"===W.signOut.state()?W.signOut.then(p):W.signIn&&"pending"===W.signIn.state()?W.signIn:U.hasAccount()?(e=function(){return U.request("GET","/_session").then(H)},O("authenticate",e)):Q().then(function(){return T=!1,p()})},U.hasValidSession=function(){return U.hasAccount()?T===!0:!1},U.hasInvalidSession=function(){return U.hasAccount()?T===!1:!1},U.signUp=function(o,n){var d;return void 0===n&&(n=""),o?U.hasAnonymousAccount()?A(o,n):U.hasAccount()?s("Must sign out first."):(o=o.toLowerCase(),d={data:JSON.stringify({_id:I(o),name:G(o),type:"user",roles:[],password:n,hoodieId:e.id(),database:U.db(),updatedAt:S(),createdAt:S(),signedUpAt:o!==e.id()?S():void 0}),contentType:"application/json"},U.request("PUT",J(o),d).then(g(o,n),m(o))):s("Username must be set.")},U.anonymousSignUp=function(){var n,d;return n=t(10),d=e.id(),U.signUp(d,n).done(function(){return o(n),U.trigger("signup:anonymous",d)})},U.hasAccount=function(){return!!U.username},U.hasAnonymousAccount=function(){return U.username===e.id()};var Y="_account.anonymousPassword";U.signIn=function(e,o,n){var d=e!==U.username;return e||(e=""),o||(o=""),e=e.toLowerCase(),n=n||{},U.hasAccount()&&d&&!n.moveData?P().then(function(){return R(e,o,n)}):R(e,o,n)},U.signOut=function(o){var n;return o=o||{},n=o.silent?D:F,U.hasAccount()?P(o).then(e.remote.disconnect).then(Q).then(n):n()},U.request=function(o,n,d){return d=d||{},e.request.apply(e,arguments)},U.db=function(){return"user/"+e.id()},U.fetch=function(e){return void 0===e&&(e=U.username),e?O("fetch",function(){return U.request("GET",J(e)).done(function(e){return V=e})}):s({name:"HoodieUnauthorizedError",message:"Not signed in"})},U.changePassword=function(o,n){return U.username?(e.remote.disconnect(),U.fetch().then(K(o,null,n))):s({name:"HoodieUnauthorizedError",message:"Not signed in"})},U.resetPassword=function(e){var o,n,d,f;return(f=u.get("_account.resetPasswordId"))?U.checkPasswordReset():(f=""+e+"/"+t(),u.set("_account.resetPasswordId",f),n=""+X+":$passwordReset/"+f,o={_id:n,name:"$passwordReset/"+f,type:"user",roles:[],password:f,createdAt:S(),updatedAt:S()},d={data:JSON.stringify(o),contentType:"application/json"},N("resetPassword",function(){return U.request("PUT","/_users/"+encodeURIComponent(n),d).done(U.checkPasswordReset).then(q)}))},U.checkPasswordReset=function(){var e,o,n,f,i;return(n=u.get("_account.resetPasswordId"))?(i="$passwordReset/"+n,f="/_users/"+encodeURIComponent(X+":"+i),e=btoa(i+":"+n),o={headers:{Authorization:"Basic "+e}},O("passwordResetStatus",function(){return U.request("GET",f,o).then(h,k).fail(function(e){return"HoodiePendingError"===e.name?(d.setTimeout(U.checkPasswordReset,1e3),void 0):U.trigger("error:passwordreset",e)})})):s("No pending password reset.")},U.changeUsername=function(e,o){return o!==U.username?(o=o||"",z(e,o.toLowerCase())):s({name:"HoodieConflictError",message:"Usernames identical"})},U.destroy=function(){return U.hasAccount()?U.fetch().then(B,C).then(F):F()},U.subscribeToOutsideEvents=function(){a(),delete U.subscribeToOutsideEvents},e.account=U}var d="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},f=e("../lib/events"),i=e("extend"),t=e("../utils/generate_id"),u=e("../utils/config"),l=e("../utils/promise/defer"),p=e("../utils/promise/reject"),c=e("../utils/promise/resolve"),s=e("../utils/promise/reject_with"),y=e("../utils/promise/resolve_with");o.exports=n},{"../lib/events":15,"../utils/config":23,"../utils/generate_id":24,"../utils/promise/defer":28,"../utils/promise/reject":31,"../utils/promise/reject_with":32,"../utils/promise/resolve":33,"../utils/promise/resolve_with":34,extend:1}],4:[function(e,o){function n(e){function o(){return u=3e4,p=d.setTimeout(e.checkConnection,u),e.isConnected()||(e.trigger("reconnected"),t=!0),i()}function n(){return u=3e3,p=d.setTimeout(e.checkConnection,u),e.isConnected()&&(e.trigger("disconnected"),t=!1),f()}var t=!0,u=3e4,l=null,p=null;e.checkConnection=function(){var f=l,i="/?hoodieId="+e.id();return f&&"pending"===f.state()?f:(d.clearTimeout(p),l=e.request("GET",i).then(o,n))},e.isConnected=function(){return t}}var d="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},f=e("../utils/promise/reject"),i=e("../utils/promise/resolve");o.exports=n},{"../utils/promise/reject":31,"../utils/promise/resolve":33}],5:[function(e,o){function n(e){function o(){return l||n(d()),l}function n(e){l=e,f.set("_hoodieId",e)}function i(){l=void 0,f.unset("_hoodieId")}function t(){l=f.get("_hoodieId"),l||(l=f.get("_account.ownerHash"))}function u(){e.on("account:cleanup",i),e.on("account:signin",function(e,o){n(o)})}var l;o.init=function(){t(),delete o.init},o.subscribeToOutsideEvents=function(){u(),delete o.subscribeToOutsideEvents},e.id=o}var d=e("../utils/generate_id"),f=e("../utils/config");o.exports=n},{"../utils/config":23,"../utils/generate_id":24}],6:[function(e,o){function n(e){function o(o,n){return n=n||{},f(n,{name:o}),d(e,n)}e.open=o}var d=e("../lib/store/remote"),f=e("extend");o.exports=n},{"../lib/store/remote":19,extend:1}],7:[function(e,o){function n(e){function o(e){return e?f.set("_remote.since",e):f.get("_remote.since")||0}function n(){e.on("remote:connect",function(){e.on("store:idle",d.push)}),e.on("remote:disconnect",function(){e.unbind("store:idle",d.push)}),e.on("disconnected",d.disconnect),e.on("reconnected",d.connect),e.on("account:signin",d.connect),e.on("account:signin:anonymous",d.connect),e.on("account:reauthenticated",d.connect),e.on("account:signout",d.disconnect)}var d=e.open(e.account.db(),{connected:!0,prefix:"",since:o,defaultObjectsToPush:e.store.changedObjects,knownObjects:e.store.index().map(function(e){var o=e.split(/\//);return{type:o[0],id:o[1]}})}),t=d.connect;d.connect=function(){return e.account.hasAccount()?t(e.account.db()):i("User has no database to connect to")},d.trigger=function(){var o;o=arguments[0];var n=2<=arguments.length?Array.prototype.slice.call(arguments,1):[];return e.trigger.apply(e,["remote:"+o].concat(Array.prototype.slice.call(n)))},d.on=function(o,n){return o=o.replace(/(^| )([^ ]+)/g,"$1remote:$2"),e.on(o,n)},d.unbind=function(o,n){return o=o.replace(/(^| )([^ ]+)/g,"$1remote:$2"),e.unbind(o,n)},d.subscribeToOutsideEvents=function(){n(),delete d.subscribeToOutsideEvents},e.remote=d}function d(e){var o=function(){n(e)};e.remote={init:o}}var f=e("../utils/config"),i=e("../utils/promise/reject_with");o.exports=d},{"../utils/config":23,"../utils/promise/reject_with":32}],8:[function(e,o){function n(e){function o(o,d,i){var t,p,c;return i=i||{},t={type:o,dataType:"json"},/^http/.test(d)||(d=(e.baseUrl||"")+l+d),/^http/.test(d)&&(t.xhrFields={withCredentials:!0},t.crossDomain=!0),t.url=d,p=u(f(t,i)),c=p.then(null,n),c.abort=p.abort,c}function n(o){var n;try{n=t(o)}catch(d){n=o.responseText?o.responseText:{name:"HoodieConnectionError",message:"Could not connect to Hoodie server at {{url}}.",url:e.baseUrl||"/"}}return i(n).promise()}function t(e){var o=JSON.parse(e.responseText);return o.name=p[e.status],o.name||(o.name=d(o.error)),o.status=e.status,o.message=o.reason||"",o.message=o.message.charAt(0).toUpperCase()+o.message.slice(1),delete o.error,delete o.reason,o}var u=$.ajax,l="/_api",p={400:"HoodieRequestError",401:"HoodieUnauthorizedError",403:"HoodieRequestError",404:"HoodieNotFoundError",409:"HoodieConflictError",412:"HoodieConflictError",500:"HoodieServerError"};e.request=o}var d=e("../utils/hoodiefy_request_error_name"),f=e("extend"),i=e("../utils/promise/reject_with");o.exports=n},{"../utils/hoodiefy_request_error_name":25,"../utils/promise/reject_with":32,extend:1}],9:[function(e,o){function n(e){function o(e){if(i.isInvalid(e.type))return new i({type:e.type});if(e.id)return t.isInvalid(e.id)?new t({id:e.id}):void 0}function n(e,o,n,d){var f,i;if(void 0===n&&(n=!1),d=d||{},f=""+e+"/"+o,n){if(l(n,{type:e,id:o}),i=l({},n),delete i.type,delete i.id,y.setObject(f,i),d.remote)return r(e,o),F[f]=l(!0,{},n),F[f]}else{if(F[f]===!1)return!1;if(F[f])return l(!0,{},F[f]);if(f=""+e+"/"+o,n=y.getObject(f),!n)return r(e,o),F[f]=!1,!1;n.type=e,n.id=o}return q(n)?(b(e,o,n,d),F[f]=!1,!1):(F[f]=l(!0,{},n),k(n)?b(e,o,F[f],d):r(e,o),l(!0,{},n))}function w(){var e,o,d,f,i,t,u;if(o=y.getItem("_dirty"))for(o=o.split(","),i=0,t=o.length;t>i;i++)u=o[i].split("/"),f=u[0],e=u[1],d=n(f,e)}function a(){e.on("account:cleanup",K.clear),e.on("account:signup",H),e.on("remote:bootstrap:start",A),e.on("remote:bootstrap:end",B),e.on("remote:bootstrap:error",C),e.on("remote:change",g),e.on("remote:push",m)}function b(e,o,n,d){var f;d=d||{},f=""+e+"/"+o,G[f]=n,x(),d.silent||z()}function r(e,o){var n;return e&&o?(n=""+e+"/"+o,delete G[n]):G={},x(),d.clearTimeout(M)}function H(){return K.findAll().pipe(function(e){var o,n,d,f;for(d=0,f=e.length;f>d;d++)n=e[d],o=""+n.type+"/"+n.id,G[o]=n;x(),z()})}function g(e,o){"remove"===e?K.remove(o.type,o.id,{remote:!0,update:o}):K.save(o.type,o.id,o,{remote:!0})}function m(e){v("sync",e),e._deleted?K.remove(e.type,e.id,{remote:!0,silent:!0}):K.save(e.type,e.id,e,{remote:!0,silent:!0})}function x(){try{if($.isEmptyObject(G))y.removeItem("_dirty");else{var e=Object.keys(G);y.setItem("_dirty",e.join(","))}}catch(o){}}function j(){return JSON.stringify(new Date).replace(/['"]/g,"")}function h(e){return N.test(e)}function k(e){return e.updatedAt?e._syncedAt?e._syncedAt<e.updatedAt:!0:!1}function q(e){return e._deleted===!0}function v(e,o,n){K.trigger(e,l(!0,{},o),n),K.trigger(o.type+":"+e,l(!0,{},o),n),K.trigger(e+":"+o.type,l(!0,{},o),n),"new"!==e&&(K.trigger(o.type+":"+o.id+":"+e,l(!0,{},o),n),K.trigger(e+":"+o.type+":"+o.id,l(!0,{},o),n)),"sync"!==e&&(K.trigger("change",e,l(!0,{},o),n),K.trigger(o.type+":change",e,l(!0,{},o),n),K.trigger("change:"+o.type,e,l(!0,{},o),n),"new"!==e&&(K.trigger(o.type+":"+o.id+":change",e,l(!0,{},o),n),K.trigger("change:"+o.type+":"+o.id,e,l(!0,{},o),n)))}function z(){K.trigger("dirty"),d.clearTimeout(M),M=d.setTimeout(function(){K.trigger("idle",K.changedObjects())},J)}function A(){L=!0,K.trigger("bootstrap:start")}function B(){var e,o,n,d;for(L=!1;I.length>0;)e=I.shift(),o=e[0],n=e[1],d=e[2],E[o].apply(E,n).then(d.resolve,d.reject);K.trigger("bootstrap:end")}function C(e){var o,n;for(L=!1;I.length>0;)o=I.shift(),n=o[2],n.reject(e);K.trigger("bootstrap:error",e)}function D(e,o){var n=p();return I.push([e,o,n]),n.promise()}var E={},F={},G={},I=[],J=2e3;E.save=function(o,d){var f,i,t,l,c,s;if(d=d||{},K.isBootstrapping()&&!d.remote)return D("save",arguments);if(o.id?(f=n(o.type,o.id),c="object"!=typeof f):(c=!0,o.id=u()),c?o.createdBy=o.createdBy||e.id():f.createdBy&&(o.createdBy=f.createdBy),!c)for(s in f)if(!o.hasOwnProperty(s))switch(s.charAt(0)){case"_":d.remote&&(o[s]=f[s]);break;case"$":d.remote||(o[s]=f[s])}d.remote?o._syncedAt=j():d.silent||(o.updatedAt=j(),o.createdAt=o.createdAt||o.updatedAt),d.local?o._$local=!0:delete o._$local,i=p();try{o=n(o.type,o.id,o,d),i.resolve(o,c).promise(),l=c?"add":"update",d.silent||v(l,o,d)}catch(y){t=y,i.reject(t.toString())}return i.promise()},E.find=function(e,o){var d,f;if(K.isBootstrapping())return D("find",arguments);try{return f=n(e,o),f?s(f):c({name:"HoodieNotFoundError",message:'"{{type}}" with id "{{id}}" could not be found'})}catch(i){return d=i,c(d)}},E.findAll=function(e){var o,d,f,i,t,u,l,c,s;if(null==e&&(e=function(){return!0}),K.isBootstrapping())return D("findAll",arguments);u=K.index(),"string"==typeof e&&(s=e,e=function(e){return e.type===s}),d=p();try{c=function(){var d,f,p,c;for(c=[],d=0,f=u.length;f>d;d++)t=u[d],h(t)&&(p=t.split("/"),o=p[0],i=p[1],l=n(o,i),l&&e(l)&&c.push(l));return c}.call(this),c.sort(function(e,o){return e.createdAt>o.createdAt?-1:e.createdAt<o.createdAt?1:0}),d.resolve(c).promise()}catch(y){f=y,d.reject(f).promise()}return d.promise()},E.remove=function(e,o,d){var f,i,t;return d=d||{},K.isBootstrapping()&&!d.remote?D("remove",arguments):(f=e+"/"+o,i=n(e,o),d.remote&&(y.removeItem(f),t=F[f]&&q(F[f]),F[f]=!1,r(e,o),t&&i)?s(i):i?(i._syncedAt?(i._deleted=!0,n(e,o,i)):(f=e+"/"+o,y.removeItem(f),F[f]=!1,r(e,o)),d.update&&(i=d.update,delete d.update),v("remove",i,d),s(i)):c({name:"HoodieNotFoundError",message:'"{{type}}" with id "{{id}}"" could not be found'}))},E.removeAll=function(e,o){return K.findAll(e).then(function(e){var n,d,f,i;for(i=[],d=0,f=e.length;f>d;d++)n=e[d],i.push(K.remove(n.type,n.id,o));return i})};var K=f(e,{validate:o,backend:{save:E.save,find:E.find,findAll:E.findAll,remove:E.remove,removeAll:E.removeAll}});K.index=function(){var e,o,n,d,f;for(n=[],e=d=0,f=y.length();f>=0?f>d:d>f;e=f>=0?++d:--d)o=y.key(e),h(o)&&n.push(o);return n},K.changedObjects=function(){var e,o,n,d,f,i,t;f=G,t=[];for(o in f)f.hasOwnProperty(o)&&(n=f[o],i=o.split("/"),d=i[0],e=i[1],n.type=d,n.id=e,t.push(n));return t},K.hasLocalChanges=function(e,o){if(!e)return!$.isEmptyObject(G);var d=[e,o].join("/");return G[d]?!0:k(n(e,o))},K.clear=function(){var e,o,n,d;e=p();try{n=K.index(),d=function(){var e,d,f;for(f=[],e=0,d=n.length;d>e;e++)o=n[e],h(o)&&f.push(y.removeItem(o));return f}.call(this),F={},r(),e.resolve(),K.trigger("clear")}catch(f){e.reject(f)}return e.promise()};var L=!1;K.isBootstrapping=function(){return L},K.isPersistent=function(){return y.isPersistent},K.subscribeToOutsideEvents=function(){a(),delete K.subscribeToOutsideEvents};var M,N=new RegExp(/^[a-z$][a-z0-9]+\/[a-z0-9]+$/);e.store=K,K.bootstrapDirtyObjects=function(){w(),delete K.bootstrapDirtyObjects}}var d="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},f=e("../lib/store/api"),i=e("../lib/error/object_type"),t=e("../lib/error/object_id"),u=e("../utils/generate_id"),l=e("extend"),p=e("../utils/promise/defer"),c=e("../utils/promise/reject_with"),s=e("../utils/promise/resolve_with"),y=e("../utils/local_storage_wrapper");o.exports=n},{"../lib/error/object_id":13,"../lib/error/object_type":14,"../lib/store/api":17,"../utils/generate_id":24,"../utils/local_storage_wrapper":27,"../utils/promise/defer":28,"../utils/promise/reject_with":32,"../utils/promise/resolve_with":34,extend:1}],10:[function(e,o){function n(e){function o(){e.on("store:change",p)}function n(o){var n=u(),d=e.store(o.type,o.id);return d.on("remove",function(e){return e.type=e.type.substr(1),e.$processedAt?n.resolve(e):(n.reject(new i({message:"Task has been aborted",task:e})),void 0)}),d.on("update",function(o){var d=o.$error;o.$error&&(o.type=o.type.substr(1),delete o.$error,d.object=o,d.message=d.message||"Something went wrong",n.reject(new i(d)),e.store.remove("$"+o.type,o.id))}),n.promise()}function l(o){var n,d=o.type,f=o.id,i=e.store.remove(d,f);return o._rev?(n=u(),e.one("store:sync:"+d+":"+f,n.resolve),i.fail(n.reject),n.promise()):i}function p(e,o,n){"$"===o.type[0]&&(o.type=o.type.substr(1),w(e,o,n))}function c(o){var n,d="$";return o&&(d+=o),n=function(e){return 0===e.type.indexOf(d)},e.store.findAll(n)}function s(e){return e.map(function(e){return b.abort(e.type.substr(1),e.id)})}function y(e,o){return e.map(function(e){return b.restart(e.type.substr(1),e.id,o)})}function w(e,o,n){var d;return"add"===e&&(e="start"),"remove"===e&&o.abortedAt&&(e="abort"),"remove"===e&&o.$processedAt&&(e="success"),"update"===e&&o.$error?(e="error",d=o.$error,delete o.$error,b.trigger("error",d,o,n),b.trigger(o.type+":error",d,o,n),b.trigger(o.type+":"+o.id+":error",d,o,n),n=t({},n,{error:d}),b.trigger("change","error",o,n),b.trigger(o.type+":change","error",o,n),b.trigger(o.type+":"+o.id+":change","error",o,n),void 0):(("start"===e||"abort"===e||"success"===e)&&(b.trigger(e,o,n),b.trigger(o.type+":"+e,o,n),"start"!==e&&b.trigger(o.type+":"+o.id+":"+e,o,n),b.trigger("change",e,o,n),b.trigger(o.type+":change",e,o,n),"start"!==e&&b.trigger(o.type+":"+o.id+":change",e,o,n)),void 0)}function a(){return JSON.stringify(new Date).replace(/['"]/g,"")}var b=function r(o,n){return f(e,r,{type:o,id:n})};d(e,{context:b,namespace:"task"}),b.start=function(o,d){return e.account.hasAccount()?e.store.add("$"+o,d).then(n):e.account.anonymousSignUp().then(function(){return b.start(o,d)})},b.abort=function(o,n){return e.store.update("$"+o,n,{abortedAt:a()}).then(l)},b.restart=function(e,o,n){var d=function(e){return t(e,n),delete e.$error,delete e.$processedAt,delete e.abortedAt,b.start(e.type,e)};return b.abort(e,o).then(d)},b.abortAll=function(e){return c(e).then(s)},b.restartAll=function(e,o){return"object"==typeof e&&(o=e),c(e).then(function(e){y(e,o)})},b.subscribeToOutsideEvents=function(){o(),delete b.subscribeToOutsideEvents},e.task=b}var d=e("../lib/events"),f=e("../lib/task/scoped"),i=e("../lib/error/error"),t=e("extend"),u=e("../utils/promise/defer");o.exports=n},{"../lib/error/error":11,"../lib/events":15,"../lib/task/scoped":22,"../utils/promise/defer":28,extend:1}],11:[function(e,o){function n(e){"string"==typeof e&&(e={message:e}),e.message||(e.message="Something went wrong"),e.name||(e.name="HoodieError"),e.message=e.message.replace(d,function(o){var n=o.match(f)[0];return e[n]}),i(this,e)}var d=/\{\{\s*\w+\s*\}\}/g,f=/\w+/,i=e("extend");n.prototype=new Error,n.prototype.constructor=n,o.exports=n},{extend:1}],12:[function(e,o){o.exports={error:e("./error"),objectId:e("./object_id"),objectType:e("./object_type")}},{"./error":11,"./object_id":13,"./object_type":14}],13:[function(e,o){function n(e){return e.name="HoodieObjectIdError",e.message='"{{id}}" is invalid object id. {{rules}}.',new d(e)}var d=e("./error"),f=/^[a-z0-9\-]+$/;n.isInvalid=function(e,o){return!(o||f).test(e||"")},n.isValid=function(e,o){return(o||f).test(e||"")},n.prototype.rules="Lowercase letters, numbers and dashes allowed only. Must start with a letter",o.exports=n},{"./error":11}],14:[function(e,o){function n(e){return e.name="HoodieObjectTypeError",e.message='"{{type}}" is invalid object type. {{rules}}.',new d(e)}var d=e("./error"),f=/^[a-z$][a-z0-9]+$/;n.isInvalid=function(e,o){return!(o||f).test(e||"")},n.isValid=function(e,o){return(o||f).test(e||"")},n.prototype.rules="lowercase letters, numbers and dashes allowed only. Must start with a letter",o.exports=n},{"./error":11}],15:[function(e,o){function n(e,o){function n(o,n){var d,f,i,t;for(d=o.split(" "),i=0,t=d.length;t>i;i++)f=u+d[i],e.eventsCallbacks[f]=e.eventsCallbacks[f]||[],e.eventsCallbacks[f].push(n)}function d(o,n){o=u+o;var d=function(){e.unbind(o,d),n.apply(null,arguments)};e.bind(o,d)}function f(){var o,n,d,f,i,t;if(o=1<=arguments.length?Array.prototype.slice.call(arguments,0):[],d=o.shift(),d=u+d,f=e.eventsCallbacks[d]){for(i=0,t=f.length;t>i;i++)n=f[i],n.apply(null,o);return!0}}function i(o,n){var d,f,i,t,l,p;if(!o)return u||(e.eventsCallbacks={}),p=Object.keys(e.eventsCallbacks),p=p.filter(function(e){return 0===e.indexOf(u)}),p.forEach(function(o){delete e.eventsCallbacks[o]}),void 0;if(o=u+o,i=e.eventsCallbacks[o]){if(!n)return delete e.eventsCallbacks[o],void 0;for(f=t=0,l=i.length;l>t;f=++t)if(d=i[f],d===n){i=i.slice(),i.splice(f,1),e.eventsCallbacks[o]=i;break}}}var t=e,u="";o=o||{},e.eventsCallbacks||(e.eventsCallbacks={}),o.context&&(t=o.context,u=o.namespace+":"),t.bind=n,t.on=n,t.one=d,t.trigger=f,t.unbind=i,t.off=i}o.exports=n},{}],16:[function(e,o){o.exports={error:e("./error"),events:e("./events"),store:e("./store"),task:e("./task")}},{"./error":12,"./events":15,"./store":18,"./task":21}],17:[function(e,o){function n(e,o){function n(e){return l(e,a)}var w={},a={hoodie:e},b=o.name||"store",r=function x(n,f){var i=l(!0,{type:n,id:f},o);return d(e,x,i)};if(f(e,{context:r,namespace:b}),r.validate=o.validate,o.validate||(r.validate=function(e){if(!e)return new i({name:"InvalidObjectError",message:"No object passed."});if(t.isInvalid(e.type,g))return new t({type:e.type,rules:m});if(e.id)return u.isInvalid(e.id,g)?new u({id:e.id,rules:m}):void 0}),r.save=function(e,o,d,f){f=f?l(!0,{},f):{};var i=l(!0,{},d,{type:e,id:o}),t=r.validate(i,f||{});return t?c(t):n(w.save(i,f||{}))},r.add=function(e,o,n){return void 0===o&&(o={}),n=n||{},r.save(e,o.id,o,n)},r.find=function(e,o){return n(w.find(e,o))},r.findOrAdd=function(e,o,d){function f(){var n;return n=l(!0,{id:o},d),r.add(e,n)}null===d&&(d={});var i=r.find(e,o).then(null,f);return n(i)},r.findAll=function(e,o){return n(w.findAll(e,o))},r.update=function(e,o,d,f){function i(n){var i,t,u;return t=l(!0,{},n),"function"==typeof d&&(d=d(t)),d?(i=function(){var e=[];for(var o in d)if(d.hasOwnProperty(o)){if(u=d[o],n[o]===u)continue;t[o]=u,e.push(o)}return e}(),i.length||f?r.save(e,o,t,f):s(t)):s(n)}var t=r.find(e,o).then(i);return n(t)},r.updateOrAdd=function(e,o,d,f){function i(){var n=l(!0,{},d,{id:o});return r.add(e,n,f)}var t=r.update(e,o,d,f).then(null,i);return n(t)},r.updateAll=function(e,o,d){var f;switch(d=d||{},!0){case"string"==typeof e:f=r.findAll(e);break;case y(e):f=e;break;case $.isArray(e):f=p().resolve(e).promise();break;default:f=r.findAll()}return f=f.then(function(e){var n,f;return $.isArray(e)||(e=[e]),f=function(){var f,i,t;for(t=[],f=0,i=e.length;i>f;f++)n=e[f],t.push(r.update(n.type,n.id,o,d));return t}(),$.when.apply(null,f)}),n(f)},r.remove=function(e,o,d){return n(w.remove(e,o,d||{}))},r.removeAll=function(e,o){return n(w.removeAll(e,o||{}))},r.decoratePromises=function(e){return l(a,e)},!o.backend)throw new Error("options.backend must be passed");var H="save find findAll remove removeAll".split(" ");H.forEach(function(e){if(!o.backend[e])throw new Error("options.backend."+e+" must be passed.");w[e]=o.backend[e]});var g=/^[^\/]+$/,m="/ not allowed";return r}var d=e("./scoped"),f=e("../events"),i=e("../error/error"),t=e("../error/object_type"),u=e("../error/object_id"),l=e("extend"),p=e("../../utils/promise/defer"),c=e("../../utils/promise/reject_with"),s=e("../../utils/promise/resolve_with"),y=e("../../utils/promise/is_promise");o.exports=n},{"../../utils/promise/defer":28,"../../utils/promise/is_promise":30,"../../utils/promise/reject_with":32,"../../utils/promise/resolve_with":34,"../error/error":11,"../error/object_id":13,"../error/object_type":14,"../events":15,"./scoped":20,extend:1}],18:[function(e,o){o.exports={api:e("./api"),remote:e("./remote"),scoped:e("./scoped")}},{"./api":17,"./remote":19,"./scoped":20}],19:[function(e,o){function n(e,o){function n(e){return"function"==typeof v?v(e):v=e}function l(e){var o,n;n=i({},e);for(o in n)if(n.hasOwnProperty(o)){if(-1!==F.indexOf(o))continue;if(!/^_/.test(o))continue;delete n[o]}return n._id=""+n.type+"/"+n.id,h.prefix&&(n._id=""+h.prefix+n._id),delete n.id,n}function p(e){var o,n;return o=e._id||e.id,delete e._id,h.prefix&&(o=o.replace(q,"")),n=o.match(/([^\/]+)\/(.*)/),e.type=n[1],e.id=n[2],e}function c(e){return e.map(p)}function s(e){var o,n,d,f;try{f=e._rev.split(/-/),n=f[0],o=f[1]}catch(i){}return n=parseInt(n,10)||0,d=y(),e._$local&&(d+="-local"),e._rev=""+(n+1)+"-"+d,e._revisions={start:1,ids:[d]},o?(e._revisions.start+=n,e._revisions.ids.push(o)):void 0}function y(){return t(9)}function w(e){return e.rows.map(function(e){return e.doc})}function a(){var e;return e=h.getSinceNr(),h.isConnected()&&!z?"/_changes?include_docs=true&since="+e+"&heartbeat=10000&feed=longpoll":"/_changes?include_docs=true&since="+e}function b(){A&&A.abort()}function r(e){return n(e.last_seq),x(e.results),h.isConnected()?h.pull():void 0}function H(o,n){if(h.isConnected())switch(o.status){case 401:return h.trigger("error:unauthenticated",n),h.disconnect();case 404:return d.setTimeout(h.pull,3e3);case 500:return h.trigger("error:server",n),d.setTimeout(h.pull,3e3),e.checkConnection();default:return"abort"===o.statusText?h.pull():(d.setTimeout(h.pull,3e3),e.checkConnection())}}function g(){z=!1,h.trigger("bootstrap:end")}function m(e){z=!1,h.trigger("bootstrap:error",e)}function x(e){for(var o,n,d,f=0;f<e.length;f++)if(o=e[f].doc,!(h.prefix&&0!==o._id.indexOf(h.prefix)||D[o._rev])){if(d=p(o),d._deleted){if(!h.isKnownObject(d))continue;n="remove",h.isKnownObject(d)}else h.isKnownObject(d)?n="update":(n="add",h.markAsKnownObject(d));h.trigger(n,d),h.trigger(n+":"+d.type,d),h.trigger(n+":"+d.type+":"+d.id,d),h.trigger("change",n,d),h.trigger("change:"+d.type,n,d),h.trigger("change:"+d.type+":"+d.id,n,d)}D={}}var j={};j.find=function(e,o){var n;return n=e+"/"+o,h.prefix&&(n=h.prefix+n),n="/"+encodeURIComponent(n),h.request("GET",n).then(p)},j.findAll=function(e){var o,n,d;switch(n="/_all_docs?include_docs=true",!0){case void 0!==e&&""!==h.prefix:d=h.prefix+e+"/";break;case void 0!==e:d=e+"/";break;case""!==h.prefix:d=h.prefix;break;default:d=""}return d&&(o=d.replace(/.$/,function(e){var o;return o=e.charCodeAt(0),String.fromCharCode(o+1)
}),n=""+n+'&startkey="'+encodeURIComponent(d)+'"&endkey="'+encodeURIComponent(o)+'"'),h.request("GET",n).then(w).then(c)},j.save=function(e){var o;return e.id||(e.id=t()),e=l(e),o="/"+encodeURIComponent(e._id),h.request("PUT",o,{data:e})},j.remove=function(e,o){return h.update(e,o,{_deleted:!0})},j.removeAll=function(e){return h.updateAll(e,{_deleted:!0})};var h=f(e,{name:o.name,backend:{save:j.save,find:j.find,findAll:j.findAll,remove:j.remove,removeAll:j.removeAll}}),k=null;h.connected=!1,h.prefix="";var q=new RegExp("^");void 0!==o.name&&(k=o.name),void 0!==o.prefix&&(h.prefix=o.prefix,q=new RegExp("^"+h.prefix)),null!==o.baseUrl&&(h.baseUrl=o.baseUrl),h.request=function(o,n,d){return d=d||{},k&&(n="/"+encodeURIComponent(k)+n),h.baseUrl&&(n=""+h.baseUrl+n),d.contentType=d.contentType||"application/json",("POST"===o||"PUT"===o)&&(d.dataType=d.dataType||"json",d.processData=d.processData||!1,d.data=JSON.stringify(d.data)),e.request(o,n,d)},h.isKnownObject=function(e){var o=""+e.type+"/"+e.id;return void 0!==E[o]?E[o]:void 0},h.markAsKnownObject=function(e){var o=""+e.type+"/"+e.id;return E[o]=1,E[o]},h.connect=function(e){return e&&(k=e),h.connected=!0,h.trigger("connect"),h.bootstrap().then(function(){h.push()})},h.disconnect=function(){h.connected=!1,h.trigger("disconnect"),A&&A.abort(),C&&C.abort()},h.isConnected=function(){return h.connected};var v=o.since||0;h.getSinceNr=function(){return"function"==typeof v?v():v};var z=!1;h.bootstrap=function(){return z=!0,h.trigger("bootstrap:start"),h.pull().done(g).fail(m)};var A,B;h.pull=function(){return A=h.request("GET",a()),h.isConnected()&&(d.clearTimeout(B),B=d.setTimeout(b,25e3)),A.done(r).fail(H)};var C,D={};h.push=function(e){var o,n=[];if($.isArray(e)||(e=G()),0===e.length)return u([]);e=e.map(function(e){return i(!0,{},e)}),n=[];for(var d=0;d<e.length;d++)o=e[d],s(o),o=l(o),n.push(o),D[o._rev]=1;return C=h.request("POST","/_bulk_docs",{data:{docs:n,new_edits:!1}}),C.done(function(){for(var o=0;o<e.length;o++)delete e[o]._revisions,h.trigger("push",e[o])}),C},h.sync=function(e){return h.push(e).then(h.pull)};var E={},F=["_id","_rev","_deleted","_revisions","_attachments"],G=function(){return[]};if(o.defaultObjectsToPush&&(G=$.isArray(o.defaultObjectsToPush)?function(){return o.defaultObjectsToPush}:o.defaultObjectsToPush),o.knownObjects)for(var I=0;I<o.knownObjects.length;I++)h.markAsKnownObject({type:o.knownObjects[I].type,id:o.knownObjects[I].id});return h}var d="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},f=e("./api"),i=e("extend"),t=e("../../utils/generate_id"),u=e("../../utils/promise/resolve_with");o.exports=n},{"../../utils/generate_id":24,"../../utils/promise/resolve_with":34,"./api":17,extend:1}],20:[function(e,o){function n(e,o,n){var f=n.name||"store",i=n.type,t=n.id,u={};return t||(d(e,{context:u,namespace:f+":"+i}),u.save=function(e,n,d){return o.save(i,e,n,d)},u.add=function(e,n){return o.add(i,e,n)},u.find=function(e){return o.find(i,e)},u.findOrAdd=function(e,n){return o.findOrAdd(i,e,n)},u.findAll=function(e){return o.findAll(i,e)},u.update=function(e,n,d){return o.update(i,e,n,d)},u.updateAll=function(e,n){return o.updateAll(i,e,n)},u.remove=function(e,n){return o.remove(i,e,n)},u.removeAll=function(e){return o.removeAll(i,e)}),t&&(d(e,{context:u,namespace:f+":"+i+":"+t}),u.save=function(e,n){return o.save(i,t,e,n)},u.find=function(){return o.find(i,t)},u.update=function(e,n){return o.update(i,t,e,n)},u.remove=function(e){return o.remove(i,t,e)}),u.decoratePromises=o.decoratePromises,u.validate=o.validate,u}var d=e("../events");o.exports=n},{"../events":15}],21:[function(e,o){o.exports={scoped:e("./scoped")}},{"./scoped":22}],22:[function(e,o){function n(e,o,n){var f=n.type,i=n.id,t={};return i||(d(e,{context:t,namespace:"task:"+f}),t.start=function(e){return o.start(f,e)},t.abort=function(e){return o.abort(f,e)},t.restart=function(e,n){return o.restart(f,e,n)},t.abortAll=function(){return o.abortAll(f)},t.restartAll=function(e){return o.restartAll(f,e)}),i&&(d(e,{context:t,namespace:"task:"+f+":"+i}),t.abort=function(){return o.abort(f,i)},t.restart=function(e){return o.restart(f,i,e)}),t}var d=e("../events");o.exports=n},{"../events":15}],23:[function(e,o){function n(){d=f.getObject(t)||{}}var d,f=e("../utils/local_storage_wrapper"),i={},t="_hoodie_config";i.set=function(e,o){d[e]=o,f.setObject(t,d)},i.get=function(e){return d[e]},i.clear=function(){return d={},f.removeItem(t)},i.unset=function(e){delete d[e],f.setObject(t,d)},n(),o.exports=i},{"../utils/local_storage_wrapper":27}],24:[function(e,o){function n(e){var o="";for(void 0===e&&(e=7),f=0;e>f;f++){var n=Math.random()*i,t=d[Math.floor(n)];o+=String(t).charAt(0)}return o}var d,f,i;d="0123456789abcdefghijklmnopqrstuvwxyz".split(""),i=d.length,o.exports=n},{}],25:[function(e,o){function n(e){return e=e.replace(d,function(e){return(e[1]||e[0]).toUpperCase()}),"Hoodie"+e+"Error"}var d=/(^\w|_\w)/g;o.exports=n},{}],26:[function(e,o){o.exports={config:e("./config"),generateId:e("./generate_id"),localStorageWrapper:e("./local_storage_wrapper"),promise:e("./promise")}},{"./config":23,"./generate_id":24,"./local_storage_wrapper":27,"./promise":29}],27:[function(e,o){function n(){i.isPersistent=d(),i.isPersistent||(i.getItem=function(){return null},i.setItem=function(){return null},i.removeItem=function(){return null},i.key=function(){return null},i.length=function(){return 0},i.isPersistent=function(){return!1})}function d(){try{if(!f.localStorage)return!1;if(localStorage.setItem("Storage-Test","1"),"1"!==localStorage.getItem("Storage-Test"))return!1;localStorage.removeItem("Storage-Test")}catch(e){return!1}return!0}var f="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},i={};i.setItem=function(e,o){f.localStorage.setItem(e,o)},i.getItem=function(e){return f.localStorage.getItem(e)},i.removeItem=function(e){return f.localStorage.removeItem(e)},i.clear=function(){return f.localStorage.clear()},i.key=function(e){return f.localStorage.key(e)},i.length=function(){return f.localStorage.length},i.setObject=function(e,o){return i.setItem(e,f.JSON.stringify(o))},i.getObject=function(e){var o=i.getItem(e);if(!o)return null;try{return f.JSON.parse(o)}catch(n){return null}},n(),o.exports=i},{}],28:[function(e,o){var n="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};o.exports=n.jQuery.Deferred},{}],29:[function(e,o){o.exports={defer:e("./defer"),isPromise:e("./is_promise"),rejectWith:e("./reject_with"),reject:e("./reject"),resolveWith:e("./resolve_with"),resolve:e("./resolve")}},{"./defer":28,"./is_promise":30,"./reject":31,"./reject_with":32,"./resolve":33,"./resolve_with":34}],30:[function(e,o){function n(e){return!(!e||"function"!=typeof e.done||"function"==typeof e.resolve)}o.exports=n},{}],31:[function(e,o){function n(){return d().reject().promise()}var d=e("./defer");o.exports=n},{"./defer":28}],32:[function(e,o){function n(e){var o=new f(e);return d().reject(o).promise()}var d=e("./defer"),f=e("../../lib/error/error");o.exports=n},{"../../lib/error/error":11,"./defer":28}],33:[function(e,o){function n(){return d().resolve().promise()}var d=e("./defer");o.exports=n},{"./defer":28}],34:[function(e,o){function n(){var e=d();return e.resolve.apply(e,arguments).promise()}var d=e("./defer");o.exports=n},{"./defer":28}]},{},[2])(2)});